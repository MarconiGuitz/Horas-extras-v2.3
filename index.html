<!DOCTYPE html>
<html lang="es">
<head>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#667eea">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Horas Extras GT</title>

<style>
body{
    font-family: system-ui, sans-serif;
    background: linear-gradient(135deg,#ffffff,#000000);
    margin:0;padding:20px
}
.container{
    max-width:700px;
    margin:auto;
    background:#fff;
    border-radius:20px;
    box-shadow:0 20px 50px rgba(0,0,0,.3);
    overflow:hidden
}
.header{
    background:linear-gradient(135deg,#000000,#82d8a6);
    color:#fff;
    padding:25px;
    text-align:center
}
.tabs{display:flex;background:#f1f1f1}
.tab{
    flex:1;padding:15px;border:none;
    background:none;font-weight:600;
    cursor:pointer;color:#666
}
.tab.active{
    background:#fff;
    color:#000000;
    border-bottom:3px solid #dbdbdb
}
.content{padding:20px}
.section{display:none}
.section.active{display:block}
label{font-weight:600;margin-bottom:5px;display:block}
input,select,textarea{
    width:100%;padding:12px;
    border-radius:10px;
    border:2px solid #eaeaea;
    margin-bottom:15px;
    font-size:16px
}
textarea{resize:vertical}
button{
    width:100%;padding:15px;
    border:none;border-radius:10px;
    background:linear-gradient(135deg,#000000,#979699);
    color:#fff;font-size:16px;
    font-weight:600;cursor:pointer
}
.resultado{
    background:linear-gradient(135deg,#b9c7b7,#599271);
    color:#fff;
    padding:20px;border-radius:15px
}
.resultado-item{
    display:flex;justify-content:space-between;
    padding:8px 0;border-bottom:1px solid rgba(255,255,255,.3)
}
.resultado-item:last-child{
    border:none;font-size:18px;font-weight:700
}
.registro{
    background:#f8f9fa;padding:15px;
    border-radius:10px;margin-bottom:10px
}
small{color:#666}
hr{border:1px solid rgba(255,255,255,.3);margin:15px 0}
</style>
</head>

<body>
<div class="container">

<div class="header">
<h2>ğŸ’° Calculadora de Horas Extras</h2>
<p>Guatemala Â· Quetzales (Q)</p>
</div>

<div class="tabs">
<button class="tab active" onclick="tab('config')">âš™ï¸ Config</button>
<button class="tab" onclick="tab('registro')">â• Registro</button>
<button class="tab" onclick="tab('historial')">ğŸ“Š Historial</button>
<button class="tab" onclick="tab('resumen')">ğŸ’µ Resumen</button>
</div>

<div class="content">

<!-- CONFIG -->
<div id="config" class="section active">
<label>ğŸ“† Tipo de pago</label>
<select id="tipoPago">
<option value="mensual">Mensual</option>
<option value="quincenal">Quincenal</option>
</select>

<label>ğŸ’µ Sueldo base mensual (Q)</label>
<input id="sueldoBase" type="number" step="0.01">

<label>â˜€ï¸ Valor hora extra diurna (Q)</label>
<input id="valorHoraDiurna" readonly>

<label>ğŸŒ™ Valor hora extra nocturna (Q)</label>
<input id="valorHoraNocturna" readonly>

<label>ğŸ¥ IGSS trabajador (%)</label>
<input id="porcentajeIGSS" value="4.83">

<label>ğŸ“„ ISR estimado (%)</label>
<input id="porcentajeISR" value="5">

<button onclick="guardarConfig()">Guardar configuraciÃ³n</button>
</div>

<!-- REGISTRO -->
<div id="registro" class="section">
<label>ğŸ“… Fecha</label>
<input id="fecha" type="date">

<label>â˜€ï¸ Horas diurnas</label>
<input id="hd" type="number" step="0.5" value="0">

<label>ğŸŒ™ Horas nocturnas</label>
<input id="hn" type="number" step="0.5" value="0">

<label>ğŸ“ Motivo</label>
<textarea id="desc"></textarea>

<button onclick="registrar()">Registrar horas</button>
</div>

<!-- HISTORIAL -->
<div id="historial" class="section">
<div id="lista"></div>
</div>

<!-- RESUMEN -->
<div id="resumen" class="section">
<div id="resultado"></div>
</div>

</div>
</div>

<script>
let config={}, registros=[];

onload=()=>{
    fecha.valueAsDate=new Date();
    config=JSON.parse(localStorage.getItem('config')||'{}');
    registros=JSON.parse(localStorage.getItem('registros')||'[]');

    if(config.sueldoBase){
        sueldoBase.value=config.sueldoBase;
        porcentajeIGSS.value=config.porcentajeIGSS;
        porcentajeISR.value=config.porcentajeISR;
        tipoPago.value=config.tipoPago;
        calcularHoras();
    }
    mostrarHistorial();
}

function tab(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
    if(id==='resumen') resumen();
}

function calcularHoras(){
    let s=parseFloat(sueldoBase.value||0);
    valorHoraDiurna.value=(s/30/8*1.5).toFixed(2);
    valorHoraNocturna.value=(s/30/8*2).toFixed(2);
}
sueldoBase.oninput=calcularHoras;

function guardarConfig(){
    config={
        tipoPago:tipoPago.value,
        sueldoBase:+sueldoBase.value,
        valorHoraDiurna:+valorHoraDiurna.value,
        valorHoraNocturna:+valorHoraNocturna.value,
        porcentajeIGSS:+porcentajeIGSS.value,
        porcentajeISR:+porcentajeISR.value
    };
    localStorage.setItem('config',JSON.stringify(config));
    alert('ConfiguraciÃ³n guardada');
}

function registrar(){
    let r={
        fecha:fecha.value,
        hd:+hd.value,
        hn:+hn.value,
        desc:desc.value,
        md:+hd.value*config.valorHoraDiurna,
        mn:+hn.value*config.valorHoraNocturna
    };
    registros.push(r);
    localStorage.setItem('registros',JSON.stringify(registros));
    hd.value=hn.value=0; desc.value='';
    mostrarHistorial();
    alert('Horas registradas');
}

function mostrarHistorial(){
    lista.innerHTML='';
    registros.forEach(r=>{
        lista.innerHTML+=`
        <div class="registro">
            <b>${r.fecha}</b><br>
            â˜€ï¸ ${r.hd}h = Q${r.md.toFixed(2)}<br>
            ğŸŒ™ ${r.hn}h = Q${r.mn.toFixed(2)}<br>
            <small>${r.desc}</small>
        </div>`;
    });
}

function resumen(){
    let horasD=registros.reduce((s,r)=>s+r.hd,0);
    let horasN=registros.reduce((s,r)=>s+r.hn,0);
    let totalD=registros.reduce((s,r)=>s+r.md,0);
    let totalN=registros.reduce((s,r)=>s+r.mn,0);
    let totalExtras=totalD+totalN;

    let devengado=config.sueldoBase+totalExtras;
    let igss=devengado*(config.porcentajeIGSS/100);
    let isr=(devengado-igss)*(config.porcentajeISR/100);
    let liquido=devengado-igss-isr;

    resultado.innerHTML=`
    <div class="resultado">
        <div class="resultado-item"><span>Sueldo base</span><span>Q${config.sueldoBase.toFixed(2)}</span></div>

        <div class="resultado-item"><span>â˜€ï¸ Horas diurnas (${horasD}h)</span><span>Q${totalD.toFixed(2)}</span></div>
        <div class="resultado-item"><span>ğŸŒ™ Horas nocturnas (${horasN}h)</span><span>Q${totalN.toFixed(2)}</span></div>

        <div class="resultado-item"><span>Total horas extras</span><span>Q${totalExtras.toFixed(2)}</span></div>

        <div class="resultado-item"><span>ğŸ’° Devengado mensual</span><span>Q${devengado.toFixed(2)}</span></div>

        <div class="resultado-item"><span>ğŸ¥ IGSS</span><span>-Q${igss.toFixed(2)}</span></div>
        <div class="resultado-item"><span>ğŸ“„ ISR</span><span>-Q${isr.toFixed(2)}</span></div>

        <div class="resultado-item"><span>ğŸ’¸ LÃ­quido mensual</span><span>Q${liquido.toFixed(2)}</span></div>

        <hr>

        <div class="resultado-item"><span>âœ… LÃ­quido quincenal</span><span>Q${(liquido/2).toFixed(2)}</span></div>
    </div>`;
}
</script>

</body>
</html>
